---
templateKey: blog-post
title: ğŸš• 1 ìš°ë²„ í´ë¡  ì½”ë”© (nomad coders)
date: 2019-04-07T08:56:56.243Z
description: ìš°ë²„ ì½”ë”© ê°•ì˜ ë¡œê·¸ 1.1 ~ 1.7
featuredpost: true
featuredimage: /img/nuber_clone.jpg
tags:
  - nomad coders
  - ìš°ë²„ í´ë¡  ì½”ë”©
---
# 

## #1.1 Project Setup. Git & installation

ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“¤ê³  ê°•ì˜ì—ì„œëŠ” nuber-serverë¡œ ë§Œë“¤ì—ˆë‹¤.

í”„ë¡œì íŠ¸ì˜ ë¼ˆëŒ€ë¥¼ ë§Œë“¤ ê±´ë°, typescript, tslint, definitelyTypedë¥¼ ì„¤ì •í•œë‹¤.

[definitedlyTyped](https://github.com/DefinitelyTyped/DefinitelyTyped)ë¥¼ ê°€ë³´ë©´ ë‹¤ì–‘í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ëŒ€í•´ íƒ€ì…ì´ ì •ì˜ë˜ì–´ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

    $ mkdir nuber-server && cd nuber-server
    $ git init
    $ echo "# NUBER SERVER" >> README.md
    $ git remote add orign (your repository)
    
    # yarnìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì ë‹¹íˆ ì„¤ì •í•˜ì
    $ yarn init
    # ê¸°ë³¸ ëª¨ë“ˆë“¤ì„ ì„¤ì¹˜í•˜ê³ 
    $ yarn add typescript ts-node tslint-config-prettier nodemon @types/node --dev
    
    # í”„ë¡œì íŠ¸ì—ì„œ ë…¸ë“œ ëª¨ë“ˆ ë””ë ‰í† ë¦¬ë§Œ .gitignoreì— ì¶”ê°€í•˜ì
    $ echo "/node_modules" >> .gitignore
    $ git add && git commit && git push origin # ì»¤ë°‹ê³¼ ì²« í‘¸ì‹œë¥¼ í•´ë†“ì

## í”„ë¡œì íŠ¸ êµ¬ì¡°

- src

  package.json

  README.md

  tsconfig.json

  tslint.json

  .gitignore

ìœ„ëŠ” ìš°ë¦¬ê°€ ë§Œë“¤ í”„ë¡œì íŠ¸ êµ¬ì¡°. src ë””ë ‰í† ë¦¬ë¥¼ ì¶”ê°€í•˜ê³  ì•„ë˜ì˜ íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ ë‚´ìš©ì„ ì±„ìš°ì.

 ë‹ˆì½œë¼ìŠ¤ê°€ ì„¤ì •í•˜ëŠ” tsconfig.json, tslint.json

- tsconfig.json

        {
          "compilerOptions": {
            "baseUrl": ".",
            "module": "commonjs",
            "target": "es5",
            "lib": ["es6", "dom", "esnext.asynciterable"],
            "sourceMap": true,
            "allowJs": true,
            "moduleResolution": "node",
            "rootDir": "src",
            "forceConsistentCasingInFileNames": true,
            "noImplicitReturns": true,
            "noImplicitThis": true,
            "noImplicitAny": false,
            "strictNullChecks": true,
            "suppressImplicitAnyIndexErrors": true,
            "noUnusedLocals": true,
            "esModuleInterop": true,
            "skipLibCheck": true,
            "experimentalDecorators": true,
            "emitDecoratorMetadata": true
          },
          "exclude": [
            "node_modules",
            "build",
            "scripts",
            "acceptance-tests",
            "webpack",
            "jest",
            "src/setupTests.ts"
          ]
        }

- tslint.json

        {
          "extends": ["tslint:recommended", "tslint-config-prettier"],
          "linterOptions": {
            "exclude": ["config/**/*.js", "node-modules/**/*."]
          },
          "rules": {
            "no-console": false,
            "member-access": false,
            "object-literal-sort-keys": false,
            "ordered-imports": true,
            "interface-name": false,
            "strict-null-checks": false
          },
          "rulesDirectory": []
        }

- @types/node ë¥¼ ì„¤ì¹˜í–ˆë”ë‹ˆ src í•˜ìœ„ë¡œ ê²ë‚˜ ìƒì„±ë˜ë˜ë°,, ì´ë˜ë„ ë˜ë‚˜..

    ![](_2019-04-07__10-137f722f-8edd-406d-9929-cc6d8137c35d.50.13.png)

      â†’ ìœ„ ë¬¸ì œ í•´ê²° !!  @type/node ëª¨ë“ˆì„ â€”dev ì˜µì…˜ìœ¼ë¡œ ì„¤ì¹˜ í•˜ì§€ ì•Šì•„ì„œ ë°œìƒí•œ ë¬¸ì œë¡œ ìƒê°ë¨.

## #1.2 Project Setup, Typescrfipt and Node.js

ì´ë²ˆì—ëŠ” package.jsonì— íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ë¹Œë“œí•˜ëŠ” ì„¤ì •ì„ ì¶”ê°€í•´ë³´ì.

- src/index.ts íŒŒì¼ì„ ì¶”ê°€í•˜ì

        console.log('work!!');

- package.json ì— scripts ë‚´ìš©ì„ ì¶”ê°€í•˜ì.

        {
          "name": "nuber-server",
        	...
          "dependencies": {},
          "devDependencies": {
            "@types/node": "^11.13.0",
        	  ...
          },
          "scripts": {
            "dev": "cd src && nodemon --exec ts-node index.ts"
          }
        }

ê·¸ë¦¬ê³  yarn dev ëª…ë ¹ì–´ë¥¼ í•˜ë©´ ì•„ë˜ ì²˜ëŸ¼ ëª…ë ¹ì–´ê°€ ì˜ ë™ì‘í•œ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![](_2019-04-07__11-060885d6-52ce-4485-ba88-f693bee162a7.19.35.png)

src/index.tsì—ì„œ ì½˜ì†” ë‚´ìš©ì„ ë³€ê²½í•˜ê³  ì €ì¥í•˜ë©´ í„°ë¯¸ë„ì— í•«ë¡œë”©ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

nodemonì€ tsíŒŒì¼ì— ëŒ€í•´ hot loading í•´ì£¼ëŠ”ë°, ì„ì˜ì˜ í™•ì¥ìì—ë„ í•«ë¡œë”©í•˜ë„ë¡ ì˜µì…˜ì„ ì¤„ ìˆ˜ ìˆë‹¤.

- src/something.graphql ë§Œë“¤ì–´ì„œ graphQL ë‚´ìš©ì„ ì ëŠ”ë‹¤.

        type Qeuryj {
          something: Boolean
        }

- package.jsonì— scriptsë¥¼ ì¢€ ë³€ê²½í•˜ì. ts ë¿ì•„ë‹ˆë¼ graphql í™•ì¥ìì—ì„œë„ hot loadingí•˜ì.

        "scripts": {
            "dev": "cd src && nodemon --exec ts-node index.ts -e ts,graphql"
        }

yarn dev ëª…ë ¹ì–´ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ê³  src/something.graphqlì—ì„œ ì¿¼ë¦¬ë¥¼ ë³€ê²½í•˜ë©´(Boolean -> String) í„°ë¯¸ë„ì— í•«ë¡œë”©ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## #1.3 A word on @types

ì´ë²ˆ ë¹„ë””ì˜¤ì—ì„œëŠ” ë”°ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ì§€ ì•Šì•˜ê³  @typed ê·¸ëŸ¬ë‹ˆê¹Œ ë…¸ë“œì—ì„œ íƒ€ì…ì´ í•„ìš”í•œ ì´ìœ ë¥¼ ë§í•´ì£¼ê³  ìˆë‹¤. ìš°ë¦¬ê°€ src/index.ts ì— ì…ë ¥í•œ console.logì—ì„œ log í•¨ìˆ˜ì˜ ì¸ìë¡œ ì–´ë–¤íƒ€ì…ì´ ëª‡ê°œê°€ ì˜¤ëŠ”ì§€ ë˜ ë¦¬í„´ì´ ë¬´ì—‡ì¸ì§€ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

![](_2019-04-07__11-dd7c9f0f-647a-48a5-b37d-5d7cdff64d3d.35.00.png)

## #1.4 GraphQL Yoga and Express part One

graphql-yogaë¡œ graphql êµ¬ì¡°ë¥¼ ì¡ì•„ì¤„ ê»€ë°, react-create-app ì²˜ëŸ¼ ê¸°ë³¸ ì„¤ì •ì„ ë°”ë¡œ ì¡ì•„ì£¼ëŠ” ëª¨ë“ˆì¸ ê²ƒ ê°™ë‹¤.

[https://github.com/prisma/graphql-yoga](https://github.com/prisma/graphql-yoga)

graphql-yogaë¥¼ ì„¤ì¹˜í•˜ì

    $ yarn add graphql-yoga

ê·¸ë¦¬ê³  ë¯¸ë“¤ì›¨ì–´ë¥¼ ì„¤ì¹˜í•  ê»€ë° helmetì€ ë³´ì•ˆì„ ìœ„í•´, morganì€ ë¡œê¹…ì„ ìœ„í•´, corsëŠ” ë‹¨ì¼ì¶œì²˜ ì •ì±…ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.

ë˜ @types ëª¨ë“ˆë„ í•¨ê»˜ ë°›ì•„ì•¼ í•œë‹¤. helmet, morgan ê°™ì€ ëª¨ë“ˆì€ javascript ëª¨ë“ˆì¸ë° typescriptì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ íƒ€ì…ì´ ì •ì˜ë˜ì–´ì•¼ í•œë‹¤.

    $ yarn add helmet morgan cors
    $ yarn add @types/helmet @types/morgan @types/cors --dev

ì´ì œ graphql-yogaë¡œ ë°±ì—”ë“œ appì„ ë§Œë“ ë‹¤. ì´ ë¶€ë¶„ì€ expressë¡œ ì•±ì„ ë§Œë“œëŠ” ê²ƒê³¼ ê±°ì˜ ìœ ì‚¬ í–ˆë‹¤.

- src/app.tsì„ ë§Œë“¤ì–´ì„œ appì„ ì‘ì„±í•´ë³´ì. ê°„ë‹¨í•˜ê²Œ ìœ„ì— ì„¤ì¹˜í•œ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì¶”ê°€í•œ graphql express appê°ì²´ë¥¼ ë§Œë“ ë‹¤.

        import { GraphQLServer } from 'graphql-yoga';
        import cors from 'cors';
        import helmet from 'helmet';
        import logger from 'morgan';
        
        class App {
          public app: GraphQLServer;
        
          constructor() {
            this.app = new GraphQLServer({});
            this.middlewares();
          }
        
          private middlewares = (): void => {
            this.app.express.use(cors());
            this.app.express.use(logger('dev'));
            this.app.express.use(helmet());
          };
        }
        
        export default new App().app;

## #1.5 GraphQL Yoga and Express part Two

ì´ë²ˆì—ëŠ” graphqlì„ ì‚¬ìš©í•˜ëŠ” expressì•±ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ì½”ë“œë¥¼ ë§Œë“¤ ê±°ë‹¤.

ìš°ì„ , src/something.graphql íŒŒì¼ì€ ì“¸ëª¨ ì—†ëŠ” íŒŒì¼ì´ë‹ˆ ì‚­ì œí•˜ì.

- src/index.ts íŒŒì¼ì— ì½˜ì†”ì„ ì§€ìš°ê³  ìœ„ì—ì„œ ë§Œë“  app.tsíŒŒì¼ì˜ ì•±ì„ ì‹¤í–‰ì‹œí‚¤ì.

        import { Options } from 'graphql-yoga';
        import app from './app';
        
        const PORT : number | string = process.env.PORT || 4000;
        const PLAYGROUND_ENDPOINT : string = "/playground";
        const GRAPHQL_ENDPOINT : string = "/graphql";
        
        const appOptions : Options = {
          port: PORT,
          playground: PLAYGROUND_ENDPOINT,
          endpoint: GRAPHQL_ENDPOINT
        }
        
        const handleAppStat = () => console.log(`Listening on port ${PORT}`)
        app.start(appOptions, handleAppStat);

ì„í¬íŠ¸ëŠ” ëª¨ë“ˆ > ë‚´ ëª¨ë“ˆ ìˆœìœ¼ë¡œ í•˜ì.

express.startëŠ” ë‘ê°œì˜ ì¸ìë¥¼ ì „ë‹¬ ë°›ëŠ”ë° @typesë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ ì²˜ëŸ¼ ì–´ë–¤ ì¸ìì˜ ì–´ë–¤ íƒ€ì…ì„ ì“°ëŠ”ì§€ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ ë¬¼ìŒí‘œëŠ” ìˆì–´ë„ ë˜ê³  ì—†ì–´ë„ ë˜ëŠ” ì¸ìë¥¼ ê°€ë¥´í‚¨ë‹¤.

    start(options: Options, callback?: ((options: Options) => void)): Promise<HttpServer | HttpsServer>;

ì§€ê¸ˆê¹Œì§€ ìˆ˜í–‰í•œ ë‚´ìš©ì€ ì‹¤ì œë¡œ ì•±ì„ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ëŠ” ì—†ì—ˆë‹¤. ìŠ¤í‚¤ë§ˆ ì˜¤ë¥˜ê°€ ëœ¨ëŠ”ë° ì´ê²Œ ì •ìƒì´ë‹¤.

GraphQLServer ëŠ”propsë¥¼ ë°›ëŠ”ë° ê·¸ ë‚´ìš©ì€ resolvers, queries, mutaion, subscfriptions ê°™ì€ ê²ƒë“¤ì´ ë“¤ì–´ê°€ì•¼ í•œë‹¤. ì§€ê¸ˆì€ ì•„ë¬´ ê²ƒë„ ì—†ê¸° ë•Œë¬¸ì— ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•Šì•˜ë‹¤.

## #1.6 API and Schema Structure part One

ì´ë²ˆì—ëŠ” APIë¥¼ ë§Œë“œëŠ” ê²ƒì„ ì§„í–‰í•œë‹¤. graphqlì— resolverì™€ type definitionì„ ì…ë ¥í•˜ëŠ” ë°©ë²•ì„ ì•Œê²Œ ëœë‹¤.

graphqlì€ ê¸°ì¡´ express ì„œë²„ì—ì„œ REST APIë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ urlì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤.

ì¼ë‹¨ ë‹ˆì½œë¼ìŠ¤ê°€ ì¡ì€ êµ¬ì¡°ëŒ€ë¡œ ë§Œë“¤ì–´ë³´ì.

- src/api/hello/sayHello/sayHello.graphql

        type Query {
          sayHello: String!
        }

- src/api/hello/sayHello/sayHello.resolvers.ts

        const resolvers = {
          Query: {
            sayHello: () => "Hey Hello how are ya"
          }
        }
        
        export default resolvers;

- src/api/hello/sayBye/sayBye.grapql

        type Query {
          sayBye: String!
        }

- src/api/hello/sayBye/sayBye.resolvers.ts

        const resolvers = {
          Query: {
            sayBye: () => "Hey Bye see ya"
          }
        }
        
        export default resolvers;

ê·¸ë¦¬ê³  ì´ì œ ë‘ê°œì˜ ëª¨ë“ˆì„ ë‹¤ìš´ ë°›ì„ ê±´ë° ìœ„ì˜ merge-grapql-schemasëŠ” sayHello, sayByeë“± ìš”ì²­ì— ëŒ€í•´ ë¶„ë¦¬ê°€ ë˜ì–´ ìˆëŠ”ë° í•˜ë‚˜ë¡œ í•©ì³ì„œ App.tsì— ì „ë‹¬í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

    $ yarn add graphql-tools merge-graphql-schemas

graphql ë¬¸ë²• ê°•ì¡°ë¥¼ ìœ„í•´ ë‹¤ìŒì˜ í™•ì¥í”„ë¡œê·¸ë¨ì„ ì„¤ì¹˜í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.

![](_2019-04-08__11-aeb57cec-2aae-4d2a-86c6-f8592777e695.08.53.png)

## #1.7 API and Schema Structure part Two

- src/schema.tsì— ì •ì˜ëœ type definitionê³¼ resolversë¡œ ìŠ¤í‚¤ë§ˆë¥¼ ë§Œë“¤ì.

        // import { GraphQLSchema } from 'graphql';
        import { makeExecutableSchema } from 'graphql-tools';
        import { fileLoader, mergeResolvers, mergeTypes } from 'merge-graphql-schemas';
        import path from 'path';
        import { IResolvers } from 'graphql-middleware/dist/types';
        
        // í˜„ì¬ ë””ë ‰í† ë¦¬ api í•˜ìœ„ì— .graphqlì„ í™•ì¥ìë¡œ ê°–ëŠ” ëª¨ë“  íŒŒì¼ì„ ê°€ì ¸ì˜´. fileLoaderê°€ ì´ëŸ° ì‘ì—…ì„ ì²˜ë¦¬í•œë‹¤.
        // ê°•ì˜ì™€ ë‹¤ë¥´ê²Œ íƒ€ì…ì„ ìˆ˜ì •í•¨ GraphQLSchema[] -> string[]
        const allTypes: string[] = fileLoader(
          path.join(__dirname, "./api/**/*.graphql")
        );
        
        // tsíŒŒì¼ì€ ë°°í¬ìš©ìœ¼ë¡œ ë¹Œë“œí•˜ë©´ jsë¡œ ë–¨ì–´ì§€ë¯€ë¡œ
        // ê°•ì˜ì™€ ë‹¤ë¥´ê²Œ íƒ€ì…ì„ ìˆ˜ì •í•¨ string[] -> IResolvers[]
        const allResolvers: IResolvers[] = fileLoader(
          path.join(__dirname, "./api/**/*.resolvers.*")
        );
        
        const mergedTypes = mergeTypes(allTypes);
        const mergedResolvers = mergeResolvers(allResolvers);
        
        const schema = makeExecutableSchema({
          typeDefs: mergedTypes,
          resolvers: mergedResolvers
        });
        
        export default schema;

- src/app.ts ì— GraphQLServer ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ìœ„ì—ì„œ ë§Œë“  ìŠ¤í‚¤ë§ˆë¥¼ ë„£ì–´ì£¼ì.

        ...
        import schema from './schema';
        
        class App {
          public app: GraphQLServer;
        
          constructor() {
            this.app = new GraphQLServer({schema});
        	  ...
          }
        
          ...
        }
        
        export default new App().app;

ë‹ˆì½œë¼ìŠ¤ëŠ” merge-graphql-schemas ëª¨ë“ˆì„ ì‚¬ìš©í•  ë•Œ íƒ€ì…ì´ ì§€ì •ì•ˆë˜ì–´ ìˆëŠ”ë°, ì˜ˆì œë¥¼ ë”°ë¼í•´ë³´ë‹ˆ íƒ€ì… ë¬¸ì œê°€ ìˆì–´ì„œ íƒ€ì…ì„ ì¡°ê¸ˆ ìˆ˜ì •í–ˆë‹¤. íƒ€ì… ìŠ¤í¬ë¦½íŠ¸ì´ê¸° ë•Œë¬¸ì— ì–´ë–¤ íƒ€ì…ì˜ ë¬¸ì œê°€ ë‚˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆì–´ì„œ ì˜ ëª°ë¼ë„ ì‰½ê²Œ ê³ ì¹  ìˆ˜ ìˆì—ˆë‹¤.

[ì•„ê¹Œ /playgroundë¡œ apië¥¼ ì—°ê²°í•´ë‘ì—ˆìœ¼ë‹ˆ ì œëŒ€ë¡œ ì‘ë™í•˜ëŠ”ì§€ ë³´ì.](http://localhost:4000/playground)

![](_2019-04-09__11-4a03c500-da6e-4960-8fa0-9d95f1952d18.01.18.png)

ì´ë ‡ê²Œ typesciprtë¡œ graphql ì´ ì ìš©ëœ express ì„œë²„ì˜ ê¸°ì´ˆë¥¼ ë§Œë“¤ì—ˆë‹¤.