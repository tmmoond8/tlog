---
templateKey: blog-post
title: ğŸš• 6 ìš°ë²„ í´ë¡  ì½”ë”© (nomad coders)
date: 2019-04-15T08:56:56.243Z
description: ìš°ë²„ ì½”ë”© ê°•ì˜ ë¡œê·¸ 1.26 ~ 1.32
featuredpost: true
featuredimage: /img/nuber_clone.jpg
tags:
  - nomad coders
  - ìš°ë²„ í´ë¡  ì½”ë”©
---
# 

## #1.26 Planning the Resolvers part One

## #1.27 Planning the Resolvers part Two

ì•ìœ¼ë¡œ í•  ì¼ì— ëŒ€í•´, ê¸°ëŠ¥ì— ëŒ€í•´ ì •ë¦¬

- README.md

        # nuber-sever
        
        Server for the (N)UBER Clone Course on Nomad Academy. GraphQL, Typescript, NodeJS
        
        ### Public Resolvers:
        
        - [ ] Sigin In / Sign Up with Facebook
        - [ ] Sign In with Email
        - [ ] Start Phone Number Verification
        - [ ] Complete Phone Number Verification
        - [ ] Sign Up with Email
        --- 
        
        ### Private Resolvers:
        
        - [ ] Verify Email
        - [ ] Get my Profile
        - [ ] Update my Profile
        - [ ] Toggle Driving Mode
        - [ ] Report Location / Orientation
        - [ ] Add Place
        - [ ] Edit Place
        - [ ] Delete Place
        - [ ] See Nearby Drivers
        - [ ] Subscribe to Nearby Drivers
        - [ ] Request a Ride
        - [ ] Get Nearby Rides
        - [ ] Subscribe to Nearby Ride Requests
        - [ ] Subscribe to Ride Status
        - [ ] Get Chat Room Messages
        - [ ] Subscribe to Chat Room Messages
        - [ ] Send a Chat Message
        
        ## Code Chaalange
        
        - [ ] Get Ride History
        - [ ] See Ride Detail

## #1.28 FacebookConnect Resolver part One

í˜ì´ìŠ¤ë¶ìœ¼ë¡œ ì‚¬ìš©ì ì¸ì¦ì„ í•˜ê¸° ìœ„í•œ ì‘ì—…ì„ í•œë‹¤. ì´ë²ˆì—ëŠ” Mutationì„ ë§Œë“¤ ê²ƒì¸ë°, Query get ì²˜ëŸ¼ ê°€ì ¸ì˜¤ëŠ” ìš”ì²­ì´ë©´, Mutationì€ postì²˜ëŸ¼ ì—…ë°ì´íŠ¸ ë˜ëŠ” ì¸ì„œíŠ¸ ì²˜ëŸ¼ ì¡°ì‘í•˜ëŠ” ê²ƒì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤.

- src/api/User/shared/User.graphql ì— fbId í•„ë“œë¥¼ ì¶”ê°€í•˜ì.

        	...
          lastOrientation: Float
          fbId: String
        }

- src/entities/User.ts ì—ë„ fbIdì— ëŒ€í•œ í•„ë“œë¥¼ ì¶”ê°€í•˜ì. ì´ ê°’ì€ í•„ìˆ˜ê°€ ì•„ë‹ˆë¯€ë¡œ `nullable: true`

        	...
        	@Column({ type: "double precision", default:0})
          lastOrientation: number;
        
          @Column({ type: "text", nullable: true})
          fbId: string;
        
          public comparePassword(password: string): Promise<boolean> {
            return bcrypt.compare(password, this.password);
          }
        	...

- src/api/User/FacebookConnect/FacebookConnect.graphql ì„ ìƒì„±í•´ì„œ ë‹¤ìŒì„ ì¶”ê°€ í•˜ì.

        type FacebookConnectResponse{
          ok: Boolean!
          error: String
          token: String
        }
        
        type Mutation {
          FacebookConnect(
            firstName: String!, 
            lastName: String!, 
            email: String, 
            fbId: String!
          ) : FacebookConnectResponse!
        }

ì •ì˜ í›„  yarn devë¥¼ ì‹¤í–‰í•˜ë©´ src/types/graph.d.ts ì— ì •ì˜í•œ íƒ€ì…ì´ ìƒì„±ë˜ì—ˆì„ ê²ƒì´ë‹¤. ì¤‘ê°„ ì¤‘ê°„ì— graphql íŒŒì¼ì„ ì •ì˜í•˜ë©´ ì–´ë–¤ ë‚´ìš©ì´ graph.d.ts íŒŒì¼ì— ì¶”ê°€ë˜ëŠ”ì§€ í™•ì¸í•˜ë©´ ì¢‹ì„ ê²ƒì´ë‹¤.

## #1.28 FacebookConnect Resolver part Two

ìœ„ì—ì„œ ì •ì˜í•œ íƒ€ì…ë“¤ì— ëŒ€í•œ resolverë¥¼ ì •ì˜í•  ì°¨ë¡€ë‹¤. graphqlì—ì„œ ìš”ì²­ íƒ€ì…ì„ ë§Œë“¤ê³  í•´ë‹¹ ì‘ë‹µì„ í•˜ê¸° ìœ„í•œ resolverë¥¼ ì •ì˜í•´ì•¼ ì‘ë‹µì´ ëœë‹¤. 

- src/entiries/User.ts í•˜ê¸°ì „ì— ìš°ì„  ê°„ë‹¨í•˜ê²Œ í•„ë“œ age í•„ë“œì— nullableì„ ë„£ì–´ì£¼ì.

        
        ...
        	@Column({ type: "text", nullable: true})Æ’âˆš
          @IsEmail()
          email: string | null;
        ...
        	@Column({ type: "int", nullable: true})
          age: number;
        
        	@Column({ type: "text", nullable: true})
          password: string;
        
          @Column({ type: "text", nullable: true})
          phoneNumber: string;
        ...

ì–´ë–¤ ìœ ì €ê°€ fbIdë¥¼ í†µí•´ ë¡œê·¸ì¸ ì‹œë„ë¥¼ í•˜ê²Œë˜ê³ , ì´ë¯¸ í•´ë‹¹ fbIdê°€ ë””ë¹„ì— ìˆìœ¼ë©´ ì´ë¯¸ íšŒì›ê°€ì…ì„ í–ˆë‹¤ê³  ìƒê°í•˜ê³  ë¡œê·¸ì¸ í† í°ì„ ì¤€ë‹¤. ê·¸ëŸ¬ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” fbIdë©´ íšŒì› ê°€ì… ì²˜ë¦¬ê°€ ì§„í–‰ëœë‹¤. 

ì•„ë˜ì—ì„œ ì²« ë²ˆì§¸ try ë¬¸ì€ ì´ë¯¸ íšŒì›ê°€ì…ì„ í–ˆëŠ”ì§€ì— ëŒ€í•œ ì²˜ë¦¬ê³ , ë‘ ë²ˆì§¸ëŠ” ì‹ ê·œ íšŒì› ê°€ì… ì²˜ë¦¬ê°€ ë˜ëŠ” tryë¬¸ì´ë‹¤.

- src/api/User/FacebookConnect/FacebookConnect.resolvers.ts íŒŒì¼ì„ ìƒì„±í•˜ê³  resolverë¥¼ ì •ì˜í•œë‹¤.

        import { Resolvers } from "src/types/resolvers";
        import { FacebookConnectMutationArgs, FacebookConnectResponse } from "src/types/graph";
        import User from "../../../entities/User"; // ì´ê±´ ê¼­ ìƒëŒ€ê²½ë¡œë¡œ í•´ì•¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.
        
        const resolvers: Resolvers = {
          Mutation: {
            FacebookConnect: async (
              _, 
              args: FacebookConnectMutationArgs
            ) : Promise<FacebookConnectResponse> => {
              const { fbId } = args;
              try {
                const exitingUser = User.findOne({ fbId })
                if(exitingUser) {
                  return {
                    ok: true,
                    error: null,
                    token: 'Comming Soon, existing'
                  }
                }
              } catch (error) {
                return {
                  ok: false,
                  error: error.message,
                  token: null
                }
              }
              try {
        
              } catch (error) {
                return {
                  ok: false,
                  error: error.message,
                  token: null
                }
              }
            }
          }
        }
        
        export default resolvers;

## #1.30 FacebookConnect Resolver part Three

ì €ë²ˆ ê°•ì˜ì— ì´ì–´ 

- src/api/User/FacebookConnect/FacebookConnect.d.ts íŒŒì¼ì—ì„œ í˜„ì¬ ë¹„ì–´ìˆëŠ” ë‘ ë²ˆì§¸ try ë¬¸ ì•ˆì„ ì±„ì›Œì£¼ì.

        ...
        			try {
                await User.create({
                  ...args,
                  profilePhoto: `http://graph.facebook.com/${fbId}/picture?type=square'`
                }).save();
                return {
                  ok: true,
                  error: null,
                  token: "Comming soon, create"
                }
              } catch (error) {
                return {
                  ok: false,
                  error: error.message,
                  token: null
                }
              }
        ...

argsì— ë„˜ì–´ì˜¨ ì‚¬ìš©ì ì •ë³´ì™€ ì¶”ê°€ì ìœ¼ë¡œ ì‚¬ìš©ìì˜ í˜ì´ìŠ¤ë¶ Imageë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í–ˆë‹¤. ì´ ë•Œ, `User.create(){}.save()`ì„ í•˜ë©´ ì €ë²ˆì— ì •ì˜í•œ `@beforeinsert` ë¡œì§ì„ íƒ€ì„œ passwordë¥¼ ì•Œì•„ì„œ í•´ì‹±í•˜ì—¬ í•´ì‹±í•œ ê°’ì„ ì €ì¥í•˜ê²Œ í•œë‹¤.!

## #1.31 Testing the FacebookConnect Resolver

ì´ì „ ê°•ì˜ì—ì„œ ì„¤ì •í•œ Mutationìœ¼ë¡œ ìš”ì²­ì„ ë³´ë‚´ë³´ì.

- [http://localhost:4000/playground](http://localhost:4000/playground) ì— ë“¤ì–´ê°€ì„œ ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ë³´ì.

        mutation {
          FacebookConnect(firstName: "TaeMin", lastName:"Moon", fbId: "2131321321", email: "test@gmail.com") {
            ok
            error
            token
          }
        }

ì´ë ‡ê²Œ í•˜ê³  ì ‘ì†í•˜ë©´ ì •ìƒì ìœ¼ë¡œ Mutaionì„ ë‚ ë¦¬ê³  ì‘ë‹µì„ ë°›ì„ ê²ƒì´ë‹¤.

## #1.32 EmailSignIn Resolver part One

ì´ë²ˆì—ëŠ” ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸í•˜ëŠ” ê²ƒì„ í•´ë³¼ ê²ƒì´ë‹¤.

- src/api/User/EmailSignIn/EmailSignIn.graphql íŒŒì¼ì„ ìƒì„±í•˜ì—¬ íƒ€ì…ì„ ì •ì˜í•˜ì.

        type EmailSignInResponse {
          ok: Boolean!
          error: String
          token: String
        }
        
        
        type Mutation {
          EmailSignIn(email: String!, password: String!): EmailSignInResponse!
        }

- src/api/User/EmailSignIn/EmailSignIn.resolvers.ts íŒŒì¼ì„ ìƒì„±í•˜ì—¬ resolverë¥¼ ì •ì˜í•˜ì.

    ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ í†µí•´ ë¡œê·¸ì¸ì„ ì‹œë„ í•˜ê²Œ ë˜ì–´ ìˆê³ , í•´ë‹¹ ìœ ì €ê°€ ë””ë¹„ì— ì—†ë‹¤ë©´ ë¡œê·¸ì¸ì€ ì‹¤íŒ¨í•œë‹¤. ìœ ì €ê°€ ìˆë‹¤ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ê²Œ ëœë‹¤.

        import { EmailSignInMutationArgs, EmailSignInResponse } from 'src/types/graph';
        import { Resolvers } from 'src/types/resolvers';
        import User from '../../../entities/User';
        
        const resolvers: Resolvers = {
          Mutation: {
            EmailSignIn: async(_, args: EmailSignInMutationArgs) :Promise<EmailSignInResponse> => {
              try {
                const { email } = args;
                const user =  User.findOne({ email });
                if(!user) {
                  return {
                    ok: false,
                    error: "No User found with that email",
                    token: null
                  }
                } else {// ì„ì‹œ ë¦¬í„´ ê°’
                  return {
                    ok: true,
                    error: 'temp',
                    token: ''
                  }
                }
              } catch (error) {
                return {
                  ok: false,
                  error: error.message,
                  token: null
                }
              }
            }
          }
        }
        
        export default resolvers;

## #1.32 EmailSignIn Resolver part Two

ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸ì„ ë§ˆë¬´ë¦¬ í•˜ì.

- src/api/User/EmailSignIn/EmailSignIn.resolvers.ts

        import { EmailSignInMutationArgs, EmailSignInResponse } from 'src/types/graph';
        import { Resolvers } from 'src/types/resolvers';
        import User from '../../../entities/User';
        
        const resolvers: Resolvers = {
          Mutation: {
            EmailSignIn: async(_, args: EmailSignInMutationArgs) :Promise<EmailSignInResponse> => {
              try {
                const { email, password } = args;
                const user =  await User.findOne({ email });
                if(!user) {
                  return {
                    ok: false,
                    error: "No User found with that email",
                    token: null
                  }
                }
                const checkPassword = await user.comparePassword(password);
                if(checkPassword) {
                  return {
                    ok: true,
                    error: null,
                    token: 'Comming soon'
                  }
                } else {
                  return {
                    ok: false,
                    error: "Wrong password",
                    token: null
                  }
                }
              } catch (error) {
                return {
                  ok: false,
                  error: error.message,
                  token: null
                }
              }
            }
          }
        }
        
        export default resolvers;

ì‹¤ì œ ê¸°ëŠ¥ì€ ì•„ì§ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ì—†ë‹¤.

- [README.md](http://readme.md) ì´ì œ ìš°ë¦° ìš°ë¦¬ê°€ í•  ì¼ ì¤‘ 2ê°€ì§€ë¥¼ ì²´í‚¹í•  ìˆ˜ ìˆë‹¤.

        ...
        - [X] Sigin In / Sign Up with Facebook
        - [X] Sign In with Email
        ...